<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>EasyWeb后台开发框架</title>
    <!--    <meta http-equiv="refresh" content="1">-->
    <!--    iview-css-->
    <link rel="stylesheet" href="/kbs/assets/libs/iview/iview.css"/>

    <!--    iview-icon-->
    <!--    iview用的是ionicons4.0.0.2版本的woff2-->
    <!--    <link href="https://cdn.bootcss.com/ionicons/4.0.0-2/css/ionicons.css" rel="stylesheet">-->
    <!--    <link rel="stylesheet" href="/kbs/assets/libs/iview/icon.css"/>-->

    <!--    layui-css-->
    <!--    <link rel="stylesheet" href="/kbs/assets/libs/layui/css/layui.css"/>-->

    <!--    admin-css-->
    <!--    <link rel="stylesheet" href="/kbs/assets/module/admin.css?v=312"/>-->

    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <style>
        .center-yvan {
            text-align: center;
            color: rgba(0, 0, 0, .55);
            font-size: 20px;
            color: #009688;
            font-weight: bold;
        }
    </style>
</head>

<body>

<div id="app">
    <template>
        <div style="background:#eee;padding: 7px">
            <Row>
                <i-col span="24">
                    <Card style="height: 63px">
                        <div>
                            <Row>
                                <i-col span="3" style="line-height: 30px">
                                    <i-select size="default" v-model="selected" :label-in-value="true"
                                              @on-change="changge">
                                        <i-option v-for="line in line " :value="line.code" :label="line.name">
                                            {{line.name}}
                                        </i-option>
                                    </i-select>
                                </i-col>
                                <i-col span="18"
                                       style="text-align: center;color:#000 ;font-size: 27px; line-height: 30px">
                                    创维自主MES系统 实时生产信息看板
                                </i-col>
                                <i-col span="3">
                                    <div id="time" style="line-height: 30px"></div>
                                </i-col>
                            </Row>
                        </div>
                    </Card>
                </i-col>
            </Row>
            <Row>
                <i-col span="4">
                    <Card style="margin-top: 4px">
                        <Row>
                            <i-col span="24">
                                <div class="center-yvan">
                                    <div>
                                        总计划量
                                    </div>
                                    <div style="margin: 4px; margin-bottom: -10px;font-size: 31px">
                                        1
                                    </div>
                                </div>
                            </i-col>
                        </Row>
                    </Card>
                </i-col>
                <i-col span="4">
                    <Card style="margin-top: 4px; margin-left: 5px">
                        <Row>
                            <i-col span="24">
                                <div class="center-yvan">
                                    <div>
                                        总投产量
                                    </div>
                                    <div style="margin: 4px; margin-bottom: -10px;font-size: 31px">
                                        1
                                    </div>
                                </div>
                            </i-col>
                        </Row>
                    </Card>
                </i-col>
                <i-col span="4">
                    <Card style="margin-top: 4px; margin-left: 5px">
                        <Row>
                            <i-col span="24">
                                <div class="center-yvan">
                                    <div>
                                        总产出量
                                    </div>
                                    <div style="margin: 4px; margin-bottom: -10px;font-size: 31px">
                                        1
                                    </div>
                                </div>
                            </i-col>
                        </Row>
                    </Card>
                </i-col>
                <i-col span="4">
                    <Card style="margin-top: 4px; margin-left: 5px">
                        <Row>
                            <i-col span="24">
                                <div class="center-yvan">
                                    <div>
                                        总计划达成率
                                    </div>
                                    <div style="margin: 4px; margin-bottom: -10px;font-size: 31px">
                                        1
                                    </div>
                                </div>
                            </i-col>
                        </Row>
                    </Card>
                </i-col>
                <i-col span="4">
                    <Card style="margin-top: 4px; margin-left: 5px">
                        <Row>
                            <i-col span="24">
                                <div class="center-yvan">
                                    <div>
                                        总直通率
                                    </div>
                                    <div style="margin: 4px; margin-bottom: -10px;font-size: 31px">
                                        100%
                                    </div>
                                </div>
                            </i-col>
                        </Row>
                    </Card>
                </i-col>
                <i-col span="4">
                    <Card style="margin-top: 4px;margin-left: 5px">
                        <Row>
                            <i-col span="24">
                                <div class="center-yvan">
                                    <div>
                                        总工时效率
                                    </div>
                                    <div style="margin: 4px; margin-bottom: -10px;font-size: 31px">
                                        1
                                    </div>
                                </div>
                            </i-col>
                        </Row>
                    </Card>
                </i-col>
            </Row>
            <Row>
                <i-col span="24">
                    <Card style="margin-top: 5px">
                        <Row>
                            <i-col span="24">
                                <div id="hdqkyc" style="height: 474px;"></div>
                            </i-col>
                        </Row>
                    </Card>
                </i-col>
                <i-col span="12">
                    <Row>
                        <i-col span="24">
                            <Card style="margin-top: 5px ; margin-left: 5px">
                                这里还是一个柱形图
                            </Card>
                        </i-col>
                    </Row>
                </i-col>
            </Row>
            <Row>
                <i-col span="24">
                    <Card style="margin-top: 5px ;">
                        <i-Table stripe :columns="columns" :data="dataLine" size="small" border height="300"></i-Table>
                    </Card>
                </i-col>
            </Row>
        </div>
    </template>
</div>

</body>
<!-- js部分 -->
<!--<script type="text/javascript" src="/kbs/assets/libs/layui/layui.js"></script>-->
<script type="text/javascript" src="/kbs/assets/libs/jquery/jquery.js"></script>
<script src="/kbs/assets/libs/vue/vue.js"></script>
<script type="text/javascript" src="/kbs/assets/libs/iview/iview.js"></script>
<script type="text/javascript" src="/kbs/assets/libs/echarts/echarts.js"></script>
<script type="text/javascript" src="/kbs/assets/libs/echarts/macarons.js"></script>
<script type="text/javascript" src="/kbs/assets/js/util.js"></script>
<script type="text/javascript" src="/kbs/assets/js/tools.js"></script>

<script>
    test = function () {
        $(function () {
            // 渲染活动情况预测
            var myCharts = echarts.init(document.getElementById('hdqkyc'), 'macarons');
            // var mData = [50, 100, 150, 80, 120, 150, 200, 250, 220, 250, 300, 350, 400, 380, 440, 450, 500, 550, 500];
            // var mData = myData;

            // 外部引入
            {
                var data = {
                    title: ['总计', '12-01', '12-02', '12-03', '12-04', '12-05', '12-06', '12-07', '12-08', '12-09'],
                    plan_production: [500, 300, 490, 333, 346, 777, 888, 864, 789, 765],
                    actual_production: [300, 400, 500, 300, 400, 500, 300, 400, 500, 500]
                };

                for (var pr in data) {
                    data[pr] = data[pr].slice(0, 15);
                }

                function getTableLine(num) {
                    var list = [];
                    var bottom = 122;
                    var height = 20;
                    for (var i = 0; i < num; i++) {
                        list.push({
                            type: 'line',
                            bottom: bottom - i * height,
                            right: 80,
                            style: {
                                fill: '#333'
                            },
                            shape: {
                                x1: 0,
                                y1: 0,
                                x2: 3200,
                                y2: 0
                            }

                        });
                    }
                    return list;
                }
                var lineList = getTableLine(3);


                option = {
                    title: [{
                        text: ' \n计划数量\n实际产出',
                        bottom: 175,
                        left: 10,
                        textStyle: {
                            lineHeight: 20,
                            fontSize: 13,
                            fontWeight: 'normal',
                            formatter: function(value) {
                                return '{table|' + value + '}';
                            },
                            rich: {
                                table: {
                                    align: 'center'
                                }
                            }
                        }
                    }],
                    tooltip: {
                        trigger: 'axis',
                        axisPointer: {
                            type: 'cross',
                            label: {
                                backgroundColor: '#283b56'
                            }
                        }
                    },
                    legend: {
                        data: ['计划数量', '实际产出']
                    },
                    grid: {
                        bottom: 147,
                        left: 80,
                        right: 80
                    },
                    xAxis: [{
                        type: 'category',
                        boundaryGap: true,
                        data: data.title,
                        axisTick: {
                            length: 64
                        },
                        axisLabel: {
                            formatter: function(value, index) {
                                var indexNum = 0;
                                for(var i = 0; i < data.title.length; i++){
                                    if(value == data.title[i]){
                                        indexNum = i;
                                    }
                                }
                                return '{table|' + value +
                                    '}\n{table|' + data.plan_production[indexNum] +
                                    '}\n'+ data.actual_production[indexNum];
                            },
                            rich: {
                                table: {
                                    lineHeight: 20,
                                    align: 'center'
                                }
                            }
                        }
                    }],
                    yAxis: [{
                        type: 'value',
                        scale: true,
                        minInterval: 1,
                        name: '数量',
                        splitLine: {
                            show: false
                        },
                        min: function(v) {
                            return Math.max((v.min - 10), 0);
                        }
                    }],
                    series: [{
                        name: '计划数量',
                        type: 'bar',
                        label: {
                            show: true,
                            position: 'top'
                        },
                        yAxisIndex: 0,
                        data: data.plan_production
                    }, {
                        name: '实际产出',
                        type: 'bar',
                        label: {
                            show: true,
                            position: 'top'
                        },
                        yAxisIndex: 0,
                        data: data.actual_production
                    }],
                    graphic: lineList
                };
            }

            // 内部引入
            /*var option = {
                title: {
                    subtext: '时段产出'
                },
                tooltip: {
                    trigger: 'axis'
                },
                /!*toolbox: {
                    show : true,
                    feature : {
                        mark : {show: true},
                        dataView : {show: true, readOnly: false},
                        magicType : {show: true, type: ['line', 'bar']},
                        restore : {show: true},
                        saveAsImage : {show: true}
                    }
                },*!/
                calculable: true,
                xAxis: [
                    {
                        type: 'category',
                        // data : ['1月','2月','3月','4月','5月','6月','7月','8月','9月','10月','11月','12月']
                        data: myTimeData
                    }
                ],
                yAxis: [
                    {
                        type: 'value'
                    }
                ],
                grid: {
                    x: 55,
                    y: 45,
                    x2: 29,
                    y2: 20,
                    borderWidth: 1
                },
                series: [
                    {
                        name: '电视机产量',
                        type: 'bar',
                        // data:[2.0, 4.9, 7.0, 23.2, 25.6, 76.7, 135.6, 162.2, 32.6, 20.0, 6.4, 3.3],
                        data: mData,
                        /!*markPoint: {
                            data: [
                                {type: 'max', name: '最大值'},
                                {type: 'min', name: '最小值'}
                            ]
                        },*!/
                        itemStyle: {
                            normal: {
                                label: {
                                    show: true, //开启显示
                                    position: 'top', //在上方显示
                                    textStyle: { //数值样式
                                        color: 'gray',
                                        fontSize: 14
                                    }
                                }
                            }
                        }
                        // 辅助线
                        ,
                        markLine: {
                            data: [
                                {type: 'average', name: '平均值'}
                            ]
                        }
                    }
                ]
            };*/
            myCharts.setOption(option);
        });
    }();
</script>
<script>
    window.setInterval("yvan.getDynamicTime()", 1000);//每隔1秒，调用一次getDateDemo()

    // 制作图表
    /*function getMycharts(myData, myTimeData) {

        // 渲染活动情况预测
        var myCharts = echarts.init(document.getElementById('hdqkyc'), myEchartsTheme);
        // var mData = [50, 100, 150, 80, 120, 150, 200, 250, 220, 250, 300, 350, 400, 380, 440, 450, 500, 550, 500];
        var mData = myData;

        // 外部引入
        {
            var data = {
                title: ['总计', '12-01', '12-02', '12-03', '12-04', '12-05', '12-06', '12-07', '12-08', '12-09'],
                plan_production: [500, 300, 490, 333, 346, 777, 888, 864, 789, 765],
                actual_production: [300, 400, 500, 300, 400, 500, 300, 400, 500, 500],
                attainment_rate: [60, 80, 90, 60, 70, 80, 90, 60, 70, 90],
                productivity: [30, 45, 88, 100, 110, 70, 80, 90, 100, 100]
            };

            for (var pr in data) {
                data[pr] = data[pr].slice(1, -1);
            }

            function getTableLine(num) {
                var list = [];
                var bottom = 122;
                var height = 20;
                for (var i = 0; i < num; i++) {
                    list.push({
                        type: 'line',
                        bottom: bottom - i * height,
                        right: 80,
                        style: {
                            fill: '#333'
                        },
                        shape: {
                            x1: 0,
                            y1: 0,
                            x2: 3200,
                            y2: 0
                        }

                    });
                }
                return list;
            }

            var lineList = getTableLine(5);


            option = {
                title: [{
                    text: ' \n计划数量\n实际产出\n达成率\n生产效率',
                    bottom: 72,
                    left: 10,
                    textStyle: {
                        lineHeight: 20,
                        fontSize: 13,
                        fontWeight: 'normal',
                        formatter: function (value) {
                            return '{table|' + value + '}';
                        },
                        rich: {
                            table: {
                                align: 'center'
                            }
                        }
                    }
                }],
                tooltip: {
                    trigger: 'axis',
                    axisPointer: {
                        type: 'cross',
                        label: {
                            backgroundColor: '#283b56'
                        }
                    }
                },
                legend: {
                    data: ['计划数量', '实际产出', '达成率', '生产效率']
                },
                grid: {
                    bottom: 150,
                    left: 80,
                    right: 80
                },
                toolbox: {
                    show: true,
                    feature: {
                        saveAsImage: {}
                    }
                },
                dataZoom: {
                    show: true,
                    start: 0,
                    end: 50,
                    maxSpan: 80
                    // zoomLock: true
                },
                xAxis: [{
                    type: 'category',
                    boundaryGap: true,
                    data: data.title,
                    axisTick: {
                        length: 108
                    },
                    axisLabel: {
                        formatter: function (value, index) {
                            var indexNum = 0;
                            for (var i = 0; i < data.title.length; i++) {
                                if (value == data.title[i]) {
                                    indexNum = i;
                                }
                            }
                            return '{table|' + value +
                                '}\n{table|' + data.plan_production[indexNum] +
                                '}\n{table|' + data.actual_production[indexNum] +
                                '}\n{table|' + data.attainment_rate[indexNum] +
                                '%}\n{table|' + data.productivity[indexNum] + '%}';
                        },
                        rich: {
                            table: {
                                lineHeight: 20,
                                align: 'center'
                            }
                        }
                    }
                }],
                yAxis: [{
                    type: 'value',
                    scale: true,
                    minInterval: 1,
                    name: '数量',
                    splitLine: {
                        show: false
                    },
                    min: function (v) {
                        return Math.max((v.min - 10), 0);
                    }
                }, {
                    type: 'value',
                    scale: true,
                    name: '百分比',
                    splitLine: {
                        show: false
                    },
                    axisLabel: {
                        formatter: '{value} %'
                    }
                }],
                series: [{
                    name: '计划数量',
                    type: 'bar',
                    label: {
                        show: true,
                        position: 'top'
                    },
                    yAxisIndex: 0,
                    data: data.plan_production
                }, {
                    name: '实际产出',
                    type: 'bar',
                    label: {
                        show: true,
                        position: 'top'
                    },
                    yAxisIndex: 0,
                    data: data.actual_production
                }, {
                    name: '达成率',
                    type: 'line',
                    label: {
                        show: true,
                        position: 'top',
                        formatter: '{c} %'
                    },
                    yAxisIndex: 1,
                    data: data.attainment_rate
                }, {
                    name: '生产效率',
                    type: 'line',
                    label: {
                        show: true,
                        position: 'top',
                        formatter: '{c} %'
                    },
                    yAxisIndex: 1,
                    data: data.productivity
                }],
                graphic: lineList
            };
        }

        // 内部引入
        var option = {
            title: {
                subtext: '时段产出'
            },
            tooltip: {
                trigger: 'axis'
            },
            /!*toolbox: {
                show : true,
                feature : {
                    mark : {show: true},
                    dataView : {show: true, readOnly: false},
                    magicType : {show: true, type: ['line', 'bar']},
                    restore : {show: true},
                    saveAsImage : {show: true}
                }
            },*!/
            calculable: true,
            xAxis: [
                {
                    type: 'category',
                    // data : ['1月','2月','3月','4月','5月','6月','7月','8月','9月','10月','11月','12月']
                    data: myTimeData
                }
            ],
            yAxis: [
                {
                    type: 'value'
                }
            ],
            grid: {
                x: 55,
                y: 45,
                x2: 29,
                y2: 20,
                borderWidth: 1
            },
            series: [
                {
                    name: '电视机产量',
                    type: 'bar',
                    // data:[2.0, 4.9, 7.0, 23.2, 25.6, 76.7, 135.6, 162.2, 32.6, 20.0, 6.4, 3.3],
                    data: mData,
                    /!*markPoint: {
                        data: [
                            {type: 'max', name: '最大值'},
                            {type: 'min', name: '最小值'}
                        ]
                    },*!/
                    itemStyle: {
                        normal: {
                            label: {
                                show: true, //开启显示
                                position: 'top', //在上方显示
                                textStyle: { //数值样式
                                    color: 'gray',
                                    fontSize: 14
                                }
                            }
                        }
                    }
                    // 辅助线
                    ,
                    markLine: {
                        data: [
                            {type: 'average', name: '平均值'}
                        ]
                    }
                }
            ]
        };
        myCharts.setOption(option);

        return myCharts;
    }*/

</script>
<script>
    var qgInter;
    var vm = new Vue({
        el: '#app',
        data: {
            visible: false,
            line:'',
            selected:'',
            columns: [
                {
                    title: '线体',
                    key: 'planAchin',
                    align: 'center'
                },
                {
                    title: '基本信息',
                    align: 'center',
                    children: [
                        {
                            title: '线长',
                            key: 'caddress',
                            align: 'center'
                        },
                        {
                            title: '人数',
                            key: 'cname',
                            align: 'center'
                        },
                        {
                            title: '线体状态',
                            key: 'cname',
                            align: 'center'
                        },
                        {
                            title: '工作时间',
                            key: 'cname',
                            align: 'center'
                        }
                    ]
                },
                {
                    title: '计划信息',
                    align: 'center',
                    children: [
                        {
                            title: '计划量',
                            key: 'cname',
                            align: 'center'
                        },
                        {
                            title: '投产量',
                            key: 'cname',
                            align: 'center'
                        },
                        {
                            title: '产出量',
                            key: 'cname',
                            align: 'center'
                        },
                        {
                            title: '计划达成率',
                            key: 'cname',
                            align: 'center'
                        },
                    ]
                },
                {
                    title: '效率信息',
                    align: 'center',
                    children: [
                        {
                            title: '产出工时',
                            key: 'cname',
                            align: 'center'
                        },
                        {
                            title: '投入工时',
                            key: 'cname',
                            align: 'center'
                        },
                        {
                            title: '工时效率',
                            key: 'cname',
                            align: 'center'
                        },
                    ]
                },
                {
                    title: '质量信息',
                    align: 'center',
                    children: [
                        {
                            title: '不良数',
                            key: 'cname',
                            align: 'center'
                        },
                        {
                            title: '直通率',
                            key: 'cname',
                            align: 'center'
                        },
                    ]
                }
            ],
            dataLine: []
        },
        created: function () {
            // 先检测cookie
            yvan.passCookie();
            // 检测浏览器
            yvan.passChrome();

            // 请求车间信息 -- 用于下拉框的车间选择显示
            util.requestget('/safe_usercenter/base/getFactorySubDepartmentByFactoryCode?code=1100', function (e) {
                var line = e.result;
                vm.line = line;
                console.log(e);
            });

        },
        methods: {
            show: function () {
                this.visible = true;
            },
            changge: function (res) {
                console.log(res);
            }
        }
    })


</script>
</html>