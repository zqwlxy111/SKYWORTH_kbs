<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>EasyWeb后台开发框架</title>
    <!--    <meta http-equiv="refresh" content="1">-->
    <!--    iview-css-->
    <link rel="stylesheet" href="/kbs/assets/libs/iview/iview.css"/>

    <!--    myCss-->
    <link rel="stylesheet" href="/kbs/assets/css/benjamin.css"/>

    <!--    iview-icon-->
    <!--    iview用的是ionicons4.0.0.2版本的woff2-->
    <!--    <link href="https://cdn.bootcss.com/ionicons/4.0.0-2/css/ionicons.css" rel="stylesheet">-->
    <!--    <link rel="stylesheet" href="/kbs/assets/libs/iview/icon.css"/>-->

    <!--    layui-css-->
    <!--    <link rel="stylesheet" href="/kbs/assets/libs/layui/css/layui.css"/>-->

    <!--    admin-css-->
    <!--    <link rel="stylesheet" href="/kbs/assets/module/admin.css?v=312"/>-->

    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body>

<div id="app">
    <template>
        <div style="background:#eee;padding: 7px">
            <Row>
                <i-col span="24">
                    <Card style="height: 63px">
                        <div>
                            <Row>
                                <i-col span="3" style="line-height: 30px">
                                    <i-select size="default" v-model="selected" :label-in-value="true"
                                              @on-change="changge">
                                        <i-option v-for="line in line " :value="line.code" :label="line.name">
                                            {{line.name}}
                                        </i-option>
                                    </i-select>
                                </i-col>
                                <i-col span="18" style="text-align: center;color:#000 ;font-size: 27px; line-height: 30px">
                                    创维自主MES系统 实时生产信息看板
                                </i-col>
                                <i-col span="3">
                                    <div id="time" style="line-height: 30px"></div>
                                </i-col>
                            </Row>
                        </div>
                    </Card>
                </i-col>
            </Row>
            <Row>
                <i-col span="4">
                    <Card style="margin-top: 4px">
                        <Row>
                            <i-col span="24">
                                <div class="center-yvan">
                                    <div>
                                        总计划量
                                    </div>
                                    <div style="margin: 4px; margin-bottom: -10px;font-size: 31px">
                                        1
                                    </div>
                                </div>
                            </i-col>
                        </Row>
                    </Card>
                </i-col>
                <i-col span="4">
                    <Card style="margin-top: 4px; margin-left: 5px">
                        <Row>
                            <i-col span="24">
                                <div class="center-yvan">
                                    <div>
                                        总投产量
                                    </div>
                                    <div style="margin: 4px; margin-bottom: -10px;font-size: 31px">
                                        1
                                    </div>
                                </div>
                            </i-col>
                        </Row>
                    </Card>
                </i-col>
                <i-col span="4">
                    <Card style="margin-top: 4px; margin-left: 5px">
                        <Row>
                            <i-col span="24">
                                <div class="center-yvan">
                                    <div>
                                        总产出量
                                    </div>
                                    <div style="margin: 4px; margin-bottom: -10px;font-size: 31px">
                                        1
                                    </div>
                                </div>
                            </i-col>
                        </Row>
                    </Card>
                </i-col>
                <i-col span="4">
                    <Card style="margin-top: 4px; margin-left: 5px">
                        <Row>
                            <i-col span="24">
                                <div class="center-yvan">
                                    <div>
                                        总计划达成率
                                    </div>
                                    <div style="margin: 4px; margin-bottom: -10px;font-size: 31px">
                                        1
                                    </div>
                                </div>
                            </i-col>
                        </Row>
                    </Card>
                </i-col>
                <i-col span="4">
                    <Card style="margin-top: 4px; margin-left: 5px">
                        <Row>
                            <i-col span="24">
                                <div class="center-yvan">
                                    <div>
                                        总直通率
                                    </div>
                                    <div style="margin: 4px; margin-bottom: -10px;font-size: 31px">
                                        100%
                                    </div>
                                </div>
                            </i-col>
                        </Row>
                    </Card>
                </i-col>
                <i-col span="4">
                    <Card style="margin-top: 4px;margin-left: 5px">
                        <Row>
                            <i-col span="24">
                                <div class="center-yvan">
                                    <div>
                                        总工时效率
                                    </div>
                                    <div style="margin: 4px; margin-bottom: -10px;font-size: 31px">
                                        1
                                    </div>
                                </div>
                            </i-col>
                        </Row>
                    </Card>
                </i-col>
            </Row>
            <Row>
                <i-col span="12">
                    <Card style="margin-top: 5px">
                        <Row>
                            <i-col span="24">
                                <div id="hdqkyc" style="width:100%;height: 250px;"></div>
                            </i-col>
                            <i-col span="24">
                                <Row>
                                    <i-col span="2">
                                        &nbsp;&nbsp;&nbsp;
                                    </i-col>
                                    <i-col span="22">
                                        <span v-for="lineName in lineByCode" class="libinglin" :style="'width:' + percent + '%'">{{lineName.lineName}}</span>
                                    </i-col>
                                </Row>
                            </i-col>
                            <i-col span="24">
                                <Row>
                                    <i-col span="2">
                                        <span style="font-size: 10px; margin-left: -10px; line-height: 25px;">
                                            计划达成率
                                        </span>
                                    </i-col>
                                    <i-col span="22">
                                        <span v-for="lineName in lineByCode" class="libinglin-1" :style="'width:' + percent + '%'">{{lineName.lineName}}</span>
                                    </i-col>
                                </Row>
                            </i-col>
                            <i-col span="24">
                                <Row>
                                    <i-col span="2">
                                        <span style="font-size: 10px; margin-left: -10px; line-height: 25px;">
                                            工时效率
                                        </span>
                                    </i-col>
                                    <i-col span="22">
                                        <span v-for="lineName in lineByCode" class="libinglin-1" :style="'width:' + percent + '%'">{{lineName.lineName}}</span>
                                    </i-col>
                                </Row>
                            </i-col>
                            <i-col span="24">
                                <Row>
                                    <i-col span="2">
                                        <span style="font-size: 10px; margin-left: -10px; line-height: 25px;">
                                            直通率
                                        </span>
                                    </i-col>
                                    <i-col span="22">
                                        <span v-for="lineName in lineByCode" class="libinglin-1" :style="'width:' + percent + '%'">{{lineName.lineName}}</span>
                                    </i-col>
                                </Row>
                            </i-col>
                        </Row>
                    </Card>
                </i-col>
                <i-col span="12">
                    <Row>
                        <i-col span="24">
                            <Card style="margin-top: 5px ; margin-left: 5px">
                                这里还是一个柱形图
                            </Card>
                        </i-col>
                    </Row>
                </i-col>
            </Row>
            <Row>
                <i-col span="24">
                    <Card style="margin-top: 5px ;">
                        <i-Table stripe :columns="columns" :data="dataLine" size="small" border height="300"></i-Table>
                    </Card>
                </i-col>
            </Row>
        </div>
    </template>
</div>

</body>
<!-- js部分 -->
<!--<script type="text/javascript" src="/kbs/assets/libs/layui/layui.js"></script>-->
<script type="text/javascript" src="/kbs/assets/libs/jquery/jquery.js"></script>
<script src="/kbs/assets/libs/vue/vue.js"></script>
<script type="text/javascript" src="/kbs/assets/libs/iview/iview.js"></script>
<script type="text/javascript" src="/kbs/assets/libs/echarts/echarts.js"></script>
<script type="text/javascript" src="/kbs/assets/libs/echarts/echartsTheme.js"></script>
<script type="text/javascript" src="/kbs/assets/js/util.js"></script>
<script type="text/javascript" src="/kbs/assets/js/tools.js"></script>

<script>
    /*test = function () {
        $(function () {
            // 外部引入
            var data = {
                title: ['111','12-01', '12-02', '12-03', '12-04', '12-05', '12-06', '12-07', '12-08', '12-09'],
                plan_production: [490,300, 490, 333, 346, 777, 888, 864, 789, 765],
                actual_production: [490,400, 500, 300, 400, 500, 300, 400, 500, 500]
            };

            for (var pr in data) {
                data[pr] = data[pr].slice(0, 20);
            }

            function getTableLine(num) {
                var list = [];
                var bottom = 122;
                var height = 25;
                for (var i = 0; i < num; i++) {
                    list.push({
                        type: 'line',
                        bottom: bottom - i * height,
                        right: 80,
                        style: {
                            fill: '#333'
                        },
                        shape: {
                            x1: 0,
                            y1: 0,
                            x2: 3200,
                            y2: 0
                        }

                    });
                }
                return list;
            }

            var lineList = getTableLine(3);


            var option = {
                title: [{
                    text: '计划数量\n实际产出\n',
                    top: 280,
                    left: 10,
                    textStyle: {
                        lineHeight: 20,
                        fontSize: 13,
                        fontWeight: 'normal',
                        formatter: function (value) {
                            return '{table|' + value + '}';
                        },
                        rich: {
                            table: {
                                align: 'center'
                            }
                        }
                    }
                }],
                tooltip: {
                    trigger: 'axis',
                    axisPointer: {
                        type: 'cross',
                        label: {
                            backgroundColor: '#283b56'
                        }
                    }
                },
                legend: {
                    data: ['计划数量', '实际产出']
                },
                grid: {
                    bottom: 147,
                    left: 80,
                    right: 80
                },
                xAxis: [{
                    type: 'category',
                    boundaryGap: true,
                    data: data.title,
                    axisTick: {
                        length: 74
                    }
                    ,
                    axisLabel: {
                        formatter: function (value, index) {
                            var indexNum = 0;
                            /!*      for (var i = 0; i < data.title.length; i++) {
                                      if (value == data.title[i]) {
                                          indexNum = i;
                                      }
                                  }*!/
                            // return '{table|' + value + '}\n'+'{table|' + data.plan_production[index] + '}\n' + data.actual_production[index];
                            // return value;
                            return value +'\n'+'\n'+ data.plan_production[index] +'\n'+'\n'+ data.actual_production[index]
                        },
                        /!*rich: {
                            table: {
                                lineHeight: 20,
                                align: 'center'
                            }
                        }*!/
                    }
                }],
                yAxis: [{
                    type: 'value',
                    scale: true,
                    minInterval: 1,
                    name: '数量',
                    splitLine: {
                        show: false
                    },
                    min: function (v) {
                        return Math.max((v.min - 10), 0);
                    }
                }],
                series: [{
                    name: '计划数量',
                    type: 'bar',
                    label: {
                        show: true,
                        position: 'top'
                    },
                    yAxisIndex: 0,
                    data: data.plan_production
                }, {
                    name: '实际产出',
                    type: 'bar',
                    label: {
                        show: true,
                        position: 'top'
                    },
                    yAxisIndex: 0,
                    data: data.actual_production
                }],
                graphic: lineList
            };
            echarts.init(document.getElementById('hdqkyc'), 'customed').setOption(option);
        });
    }();*/
</script>
<script>
    window.setInterval("yvan.getDynamicTime()", 1000);//每隔1秒，调用一次getDateDemo()
</script>
<script>
    var qgInter;
    var vm = new Vue({
        el: '#app',
        data: {
            visible: false,
            line: '',           // 下拉框的line
            lineByCode:'',      // 具体某个车间的具体信息
            selected: '',
            percent:'',
            columns: [
                {
                    title: '线体',
                    key: 'planAchin',
                    align: 'center'
                },
                {
                    title: '基本信息',
                    align: 'center',
                    children: [
                        {
                            title: '线长',
                            key: 'caddress',
                            align: 'center'
                        },
                        {
                            title: '人数',
                            key: 'cname',
                            align: 'center'
                        },
                        {
                            title: '线体状态',
                            key: 'cname',
                            align: 'center'
                        },
                        {
                            title: '工作时间',
                            key: 'cname',
                            align: 'center'
                        }
                    ]
                },
                {
                    title: '计划信息',
                    align: 'center',
                    children: [
                        {
                            title: '计划量',
                            key: 'cname',
                            align: 'center'
                        },
                        {
                            title: '投产量',
                            key: 'cname',
                            align: 'center'
                        },
                        {
                            title: '产出量',
                            key: 'cname',
                            align: 'center'
                        },
                        {
                            title: '计划达成率',
                            key: 'cname',
                            align: 'center'
                        },
                    ]
                },
                {
                    title: '效率信息',
                    align: 'center',
                    children: [
                        {
                            title: '产出工时',
                            key: 'cname',
                            align: 'center'
                        },
                        {
                            title: '投入工时',
                            key: 'cname',
                            align: 'center'
                        },
                        {
                            title: '工时效率',
                            key: 'cname',
                            align: 'center'
                        },
                    ]
                },
                {
                    title: '质量信息',
                    align: 'center',
                    children: [
                        {
                            title: '不良数',
                            key: 'cname',
                            align: 'center'
                        },
                        {
                            title: '直通率',
                            key: 'cname',
                            align: 'center'
                        },
                    ]
                }
            ],
            dataLine: []
        },
        created: function () {
            // 先检测cookie
            yvan.passCookie();
            // 检测浏览器
            yvan.passChrome();

            // 请求车间信息 -- 用于下拉框的车间选择显示
            util.requestget('/safe_usercenter/base/getFactorySubDepartmentByFactoryCode?code=1100', function (e) {
                var line = e.result;
                vm.line = line;
                console.log(e);
            });

            util.requestget('/mes/kb/getRealProductInfoGroupFactorySubDepartment?code=11001238', function (e) {
                console.log(e);
                vm.lineByCode = e.result;
                var leng = (100 / e.result.length);
                vm.percent = leng;
            });

        },
        methods: {
            show: function () {
                this.visible = true;
            },
            changge: function (res) {
                console.log(res);

                yvan.getMyCharts('hdqkyc');
            }
        }
    })


</script>
</html>